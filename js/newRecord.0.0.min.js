var bodyDocumentHeight=document.body.clientHeight,localStorger=new LocalStorger,token=localStorger.getToObject("token"),campaign=localStorger.getToObject("campaign"),modal=$("#msn"),boxProcess=$("#box-process"),containerTerms="",waitingTime=new Date,timesClicksPagers=80,timesContexSetInteval=null,limitTime=100,context='<div id="containerstillkeyboard" class="still-keyboard-close fluid-screen"></div>',contextSon1=$("#context-son-1"),contextThis=$("#context-this");function getBoxProcess(e,t){t?e.html(' <div   class="box-process" ><div class="box-process item">Buscando Endereço...</div> </div>'):e.html("")}function openTerms(e){var t=bodyDocumentHeight-250;try{var o=(o=`<div class="modal" tabindex="-1" id="terms">
                            <div class="modal-dialog modal-lg">
                            <div class="modal-content">
                                <div class="modal-header">
                                <h5 class="modal-title">TERMOS DE SERVIÇO ROI </h5>
                                <button type="button" class="btn-close onClickClose"   data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                 <div class="modal-body">
                                 
                                  <div id="divContent" class=' ' style="height:`+t+`px; overflow:auto; ">
                                  :conteudo
                                  </div>
                                </div>
                                <div class="modal-footer">
                                <button type="button" class="btn btn-secondary onClickClose" data-bs-dismiss="modal">Close</button>
                               
                                </div>
                            </div>
                            </div>
                        </div>`).replace(":conteudo",e);containerTerms.html(o).show(),$("#terms").slideDown(1).show(),$(".onClickClose").on("click",function(){$("#terms").slideDown(60),$("#terms").slideUp(1e3,function(){containerTerms.html("").hide()})})}catch(e){console.log(e)}}function searchByAddress(e){var t=bodyDocumentHeight;try{$("#listAddress").html(""),inputSeachAddress=$("#inputSeachAddress"),contextThis.html(""),contextSon1.html(context),inputSeachAddress.attr("height",t),inputSeachAddress.show(),__initStillKeyboard(),window.scrollTo(0,0),$("#input_address_seach").val(""),$("#input_address_seach").focus(),$("#input_address_seach").click(),$("#input_address_seach").change(function(){$(this).keyup()}),$("#input_address_seach").keyup(function(){console.log($(this).val());var n=[],e=Api();try{var t={headers:{Authorization:"Bearer "+token.data.token}},o=e.url+e.routes.publiczipcodessearchaddress+"="+$(this).val();$("#listAddress").html(""),$("#listAddress").html('<li class="p-3"><b>Pesquisando...</b></li>'),axios.get(o,t).then(function(e){if(void 0!==e.data.zipcodes)if(0<e.data.zipcodes.length){$("#listAddress").html("");var t=e.data.zipcodes;for(next=0;next<t.length;next++){var o,s,i=t[next].public_place+" ,"+t[next].district+" ,"+t[next].state;-1===n.indexOf(i)&&(o=t[next].id,s=t[next].postal_code,n.push(i),$("#listAddress").append('<li   zipcode="'+s+'" zipcodeId="'+o+'" class="onClickListSelected p-3 list-group-item list-group-item-action ">'+i+"</li>"))}$(".onClickListSelected").on("click",function(){var e=$(this).attr("zipcodeId"),t=$(this).attr("zipcode"),o=$(this).text();"null"!==t&&$("#input_zipcode").val(t.replace(/[^\d]+/g,"")),$("#__zipcodeid__").val(e),$("#input_address").val(o),$("#btnCloseSeach").click()})}else $("#listAddress").html(""),$("#listAddress").html('<li class="p-3"><b>Endereço não Localizado...</b></li>');else $("#listAddress").html("")}).then(e=>{console.log("1 ",e)}).catch(e=>{})}catch(e){}}),$("#btnCloseSeach").on("click",function(){$("#input_address_seach").hasClass("onchange")&&$(this).removeClass("onchange"),__closeKeyBoard(),contextSon1.html(""),contextThis.html(""),contextThis.html(context),inputSeachAddress.hide(),__initStillKeyboard(),$("#input_zipcode").focus(),$("#input_zipcode").click()})}catch(e){console.log(e)}}null!=token&&0!=token.data.length&&null!=campaign||(location.href="/"),$(document).ready(function(){containerTerms=$("#containerTerms"),$(".seachAddress").on("click",function(){searchByAddress($(this).attr("inputparent"))}),$(".onclickTerms").on("click",function(){var e=Api();try{var t={headers:{Authorization:"Bearer "+token.data.token}},o=e.url+e.routes.totemcorporationscontract;axios.get(o,t).then(function(e){console.log(e),openTerms(e.data.contract)}).then(e=>{console.log("1 ",e)}).catch(e=>{})}catch(e){}}),timesContexSetInteval=setInterval(function(){timesClicksPagers--},1200),$("body").mousemove(function(){timesClicksPagers<limitTime&&timesClicksPagers++}),$(window).bind("beforeunload",function(){clearInterval(timesContexSetInteval)}),$("#input_address").focus(function(){}),$("#input_zipcode").change(function(){$(this).keyup()}),$("#input_zipcode").keyup(function(){var e,t,o;waitingTime=new Date,getBoxProcess(boxProcess,!0),setTimeout((e=$("#input_zipcode"),t=$(e).val(),o=Api(),e={headers:{Authorization:"Bearer "+token.data.token}},t=o.url+o.routes.publiczipcodes+"/search?postal_code="+t,void axios.get(t,e).then(function(e){$("#__zipcodeid__").val(""),$("#input_address").val("");try{var t;null!=e.data.zipcodes&&(t=e.data.zipcodes[0].public_place+", "+e.data.zipcodes[0].district+", "+e.data.zipcodes[0].state,$("#__zipcodeid__").val(e.data.zipcodes[0].id),$("#input_address").val(t)),getBoxProcess(boxProcess,!1)}catch(e){getBoxProcess(boxProcess,!1)}})),1e3)}),$("#btnSave").on("click",function(){waitingTime=new Date;var e={full_name:$("#input_name").val(),phone:$("#input_phone").val(),address:$("#input_address").val(),zipcode_id:$("#__zipcodeid__").val(),number_house:$("#input_number").val(),campaign_id:campaign.id};$("#btnSave").val("PROCESSANDO...");let t;Swal.fire({title:"",html:"Processando.",timer:3e3,timerProgressBar:!0,didOpen:()=>{Swal.showLoading(),t=setInterval(()=>{const e=Swal.getContent();if(e){const t=e.querySelector("b");t&&(t.textContent=Swal.getTimerLeft())}},100)},willClose:()=>{clearInterval(t)}}).then(e=>{e.dismiss===Swal.DismissReason.timer&&console.log("I was closed by the timer")});try{localStorger.insert("customers",JSON.stringify(e));var o=Api(),s={headers:{Authorization:"Bearer "+token.data.token}};axios.post(o.url+o.routes.totemcustomersstore,e,s).then(function(e){location.href="/printcupom"}).then(e=>{console.log("1 ",e)}).catch(e=>{console.log("2 ",e.response.data[0].message),Swal.fire({position:"top-end",icon:"error",title:"Oops...",text:e.response.data[0].message,showConfirmButton:!1,timer:3500,willClose:()=>{__closeKeyBoard(),window.location.href="/"}}),setTimeout(function(){$("#btnSave").val("ENVIAR"),$("#msn-modal-body").html(""),$("#input_zipcode").val("")},3e3)})}catch(e){console.log(e)}})});