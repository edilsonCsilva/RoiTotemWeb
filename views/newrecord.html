<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="/img/favicon.ico" sizes="16x16" type="image/png">

    <!-- Bootstrap CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet" >
    <link href="/css/cores.css" rel="stylesheet" >
    <link href="/css/style-custom.css" rel="stylesheet" >
    <link href="/css/stillkeyboard.0.0.1.min.css" rel="stylesheet" >
    <link rel="stylesheet" href="/fontawesome/css/font-awesome.min.css">

    <title>{{title}}</title>
  </head>
  <body class="theme-roi-base">
    <header class="theme-border-black">
        <!-- Just an image -->
        <nav class="navbar theme-roi-brand-logo-base">
            <div class="container">
            <a class="navbar-brand mx-auto " href="javascript:void(0)" >
                <img src="/img/logoroi.png"  class="brand-logo" alt=""  >
            </a>
            </div>
        </nav>
    </header>

    <div class="container ">
        <!-- Content here -->

        <div class="row" >
            <div class="col-sm-12 p-3" >
                <div class="text-center" >
                        <label><h1 class="colors-write">É RAPIDINHO, VAMOS LÁ!</h1></label>
                </div>    
            </div>

            <div class="container  ">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="card p-2 theme-colors-btn-defalut-bg-no-hover " >
                            
                            <div class="card-body">
                              <h5 class="card-title text-center p-2">POR FAVOR, PREENCHA SEUS DADOS</h5>
                              

                              <div class="row p-4">
                                  <div class="col-sm-6 ">
                                    <input type="hidden" id="__zipcodeid__" value="" /> 
                                    <input type="text" stilltype="letters" taborder="1" id="input_name"
                                    class=" onfocusClick form-control theme-border-black theme-btn-round 
                                    theme-input-round"  placeholder="Nome">
                                  </div>
                                  <div class="col-sm-6">
                                    <input type="text"  stilltype="num" taborder="2" id="input_phone" 
                                    class="onfocusClick form-control theme-border-black theme-btn-round theme-input-round"
                                     placeholder="Celular"> 
                                </div>
                              </div>
                              
                              <div class="row p-4 ">
                                <div class="col-sm-6 ">
                                  <input type="text" stilltype="letters" taborder="3"  id="input_address" 
                                  class=" onfocusClick form-control theme-border-black theme-btn-round theme-input-round"
                                   placeholder="Endereço">
                                </div>
                                <div class="col-sm-6">
                                  
                                    <div class="row p-1">

                                        <div class="col">
                                            <input type="text" stilltype="num" taborder="4"  id="input_zipcode" 
                                            class="onfocusClick onchange  form-control  theme-border-black theme-btn-round theme-input-round" 
                                            placeholder="Cep"> 
                                        </div>
                                        <div class="col">
                                            <input type="text" stilltype="num" taborder="5"  id="input_number" class="onfocusClick form-control theme-border-black theme-btn-round theme-input-round"
                                             placeholder="Nº"> 
                                        </div>
                                        <div class="col">
                                            <input type="button" id="btnSave" class="form-control  theme-border-black
                                             theme-btn-round theme-input-round theme-colors-btn-defalut-primary-bg " value="ENVIAR"> 
                                        </div>
                                        

                                    </div>
                              </div>

                              <div class="row p-4">
                                    <div class="col-sm-12"><hr></div>
                              </div>

                              <div class="row p-5">
                              
                                <fieldset class="form-group">
                                    <div class="row">
                                      
                                      <div class="col-sm-10">
                                        <div class="form-check">
                                          <input class="form-check-input" type="radio" name="gridRadios"
                                           id="gridRadios1" value="option1" >
                                          <label class="form-check-label" for="gridRadios1">
                                            Aceito receber ofertas e novidades do Grupo Still
                                          </label>
                                        </div>
                                        <div class="form-check">
                                          <input class="form-check-input" checked type="radio" name="gridRadios" 
                                          id="gridRadios2" value="option2">
                                          <label class="form-check-label" for="gridRadios2">
                                            Li e aceito os 
                                            <a href="javascript:void(0)">Termos de Uso</a> e as
                                            <a href="javascript:void(0)">Políticas de Privacidade</a> 
                                          </label>
                                   
                                      </div>
                                    </div>
                                  </fieldset>


                             </div>
                                  


                            </div>
                            

                           



                            </div>
                          </div>

                    </div>

                </div>

            </div>
            





          
        </div>
        <!-- Content here -->

    </div>



    <div id="containerstillkeyboard" class="still-keyboard-close"></div>
     




   
    <!-- Option 1: Bootstrap Bundle with Popper -->
   
    <script src="/js/bootstrap.bundle.min.js" ></script>
    <script src="/js/bootstrap.min.js" ></script>
    <script src="/js/jquery-3.5.1.min.js" ></script>
    <script src="/js/configs.js" ></script>
    <script src="/js/system.js" ></script>
    <script src="/js/localStorger.js" ></script>
    <script src="/js/axios.min.js" ></script>
    <script src="/js/stillkeyboard.0.0.1.min.js" ></script>


    <script>

    
    var localStorger = new LocalStorger()
    var token=localStorger.getToObject("token")
    var campaign=localStorger.getToObject("campaign")
    
    
    if(token==null || token.data.length ==0 || campaign==null){
        location.href="/"
    }

    $(document).ready(function(){

        setTimeout(function(){
              window.location.href="/"                
           },6*10000) 
           


        $("#input_zipcode").change(function(){
             $(this).keyup()
        })

        $("#input_zipcode").keyup(function(){
            
            setTimeout(function(el){
                var zipcode=$(el).val()
                var configs =  Api();
                var configRequestsAxios = {
                                headers: {
                                'Authorization': 'Bearer ' +token.data.token
                                }
                            }
                var apiUrl=configs.url+configs.routes.publiczipcodes+"/search?postal_code="+ zipcode
                axios.get(apiUrl,configRequestsAxios)
                        .then(function(response){
                            $("#__zipcodeid__").val("")
                            $("#input_address").val("")
                            try{
                                if(response.data.zipcodes!=null){
                                    var address =response.data.zipcodes[0].public_place
                                    +", "+response.data.zipcodes[0].district
                                    +", "+response.data.zipcodes[0].state
                                    $("#__zipcodeid__").val(response.data.zipcodes[0].id)
                                    $("#input_address").val(address)
                                }
                            }catch(e){}
                            console.log(response)
                        })
            }($("#input_zipcode")),1000)
        })

        $("#btnSave").on("click",function(){
            var data={
                full_name:$("#input_name").val(),
                phone:$("#input_phone").val(),
                address:$("#input_address").val(),
                zipcode_id:$("#__zipcodeid__").val(),
                number_house:$("#input_number").val(),
                campaign_id:campaign.id
            }

            try{
                localStorger.insert("customers",JSON.stringify(data))
                var configs =  Api();
                var configRequestsAxios = {
                                headers: {
                                'Authorization': 'Bearer ' +token.data.token
                                }
                            }
                           axios.post(configs.url+configs.routes.totemcustomersstore, data,configRequestsAxios)
                                .then(function(response){
                                    alert("")
                                    location.href="/printcupom"
                                }).then(data => {
                                    console.log("1 ",data)

                                })
                                .catch(error => {
                                        console.log("2 ",error.response.data.error)
                                        setTimeout(function(){
                                                location.href="/"
                                        },2000)
                                });
                }catch(e){
                    console.log(e)
                }
           
        })
         
    });
    </script>


    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js" integrity="sha384-q2kxQ16AaE6UbzuKqyBE9/u/KzioAlnx2maXQHiDX9d4/zp8Ok3f+M7DPm+Ib6IU" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.min.js" integrity="sha384-pQQkAEnwaBkjpqZ8RU1fF1AKtTcHJwFl3pblpTlHXybJjHpMYo79HY3hIi4NKxyj" crossorigin="anonymous"></script>
    -->
  </body>
</html>